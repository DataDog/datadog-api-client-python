interactions:
- request:
    body: null
    headers:
      accept:
      - application/json
    method: GET
    uri: https://api.datadoghq.com/api/v2/sensitive-data-scanner/config
  response:
    body:
      string: '{"data":{"attributes":{},"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","relationships":{"groups":{"data":[{"id":"40f36cf1-dc37-46fd-a4df-93d55971f6c3","type":"sensitive_data_scanner_group"},{"id":"8b25277f-4192-4079-88b9-be2d39c2a5a9","type":"sensitive_data_scanner_group"},{"id":"6b02bc6f-1588-433d-8a5d-fab867ac386d","type":"sensitive_data_scanner_group"},{"id":"99cae8b0-3cd0-4fc8-88ba-501c8ae5c8bb","type":"sensitive_data_scanner_group"},{"id":"14fa0ce6-9e1c-4570-87ec-c3d42122166e","type":"sensitive_data_scanner_group"},{"id":"e83cca8a-afe8-4012-92c9-b70a3ca72483","type":"sensitive_data_scanner_group"},{"id":"fa845597-18b7-41d1-88c3-c9f0e5ccc107","type":"sensitive_data_scanner_group"},{"id":"5ea46624-4909-401e-8a99-492d916d493e","type":"sensitive_data_scanner_group"},{"id":"1b1c8fb7-2564-475e-af6f-3d1b4e740137","type":"sensitive_data_scanner_group"},{"id":"38acc1c6-416d-4dcd-bf13-d0c9ef189c28","type":"sensitive_data_scanner_group"},{"id":"75dc5014-bafb-4e6f-bee1-c5eed459ae87","type":"sensitive_data_scanner_group"},{"id":"478f26b5-06a5-4a2f-abfc-34a4c723ca00","type":"sensitive_data_scanner_group"},{"id":"49f14d2d-c39f-4b7d-9c1a-faebeca167ca","type":"sensitive_data_scanner_group"},{"id":"aed4eaf2-8223-4922-b7be-d14f719c41b4","type":"sensitive_data_scanner_group"},{"id":"bcc8bd1a-5e67-40c7-9c8c-44318df2f5a5","type":"sensitive_data_scanner_group"},{"id":"61fb1574-8541-4e67-96eb-099c6b81f159","type":"sensitive_data_scanner_group"},{"id":"414d38df-0daa-4d10-ac56-faf07e1fa67b","type":"sensitive_data_scanner_group"},{"id":"e1dd1a1d-7a06-4502-96c8-331b8da25927","type":"sensitive_data_scanner_group"},{"id":"cd20f1cf-6f14-4967-9794-f28f08ddb5a5","type":"sensitive_data_scanner_group"}]}},"type":"sensitive_data_scanner_configuration"},"included":[{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769279092","product_list":["logs"],"samplings":[]},"id":"40f36cf1-dc37-46fd-a4df-93d55971f6c3","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769279092","product_list":["logs"],"samplings":[]},"id":"8b25277f-4192-4079-88b9-be2d39c2a5a9","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769279092","product_list":["logs"],"samplings":[]},"id":"6b02bc6f-1588-433d-8a5d-fab867ac386d","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769279092","product_list":["logs"],"samplings":[]},"id":"99cae8b0-3cd0-4fc8-88ba-501c8ae5c8bb","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769279092","product_list":["logs"],"samplings":[]},"id":"14fa0ce6-9e1c-4570-87ec-c3d42122166e","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769293492","product_list":["logs"],"samplings":[]},"id":"e83cca8a-afe8-4012-92c9-b70a3ca72483","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769293492","product_list":["logs"],"samplings":[]},"id":"fa845597-18b7-41d1-88c3-c9f0e5ccc107","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769293492","product_list":["logs"],"samplings":[]},"id":"5ea46624-4909-401e-8a99-492d916d493e","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769293492","product_list":["logs"],"samplings":[]},"id":"1b1c8fb7-2564-475e-af6f-3d1b4e740137","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769293492","product_list":["logs"],"samplings":[]},"id":"38acc1c6-416d-4dcd-bf13-d0c9ef189c28","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769307892","product_list":["logs"],"samplings":[]},"id":"75dc5014-bafb-4e6f-bee1-c5eed459ae87","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769307892","product_list":["logs"],"samplings":[]},"id":"478f26b5-06a5-4a2f-abfc-34a4c723ca00","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769307892","product_list":["logs"],"samplings":[]},"id":"49f14d2d-c39f-4b7d-9c1a-faebeca167ca","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769307892","product_list":["logs"],"samplings":[]},"id":"aed4eaf2-8223-4922-b7be-d14f719c41b4","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769307892","product_list":["logs"],"samplings":[]},"id":"bcc8bd1a-5e67-40c7-9c8c-44318df2f5a5","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769322292","product_list":["logs"],"samplings":[]},"id":"61fb1574-8541-4e67-96eb-099c6b81f159","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769322292","product_list":["logs"],"samplings":[]},"id":"414d38df-0daa-4d10-ac56-faf07e1fa67b","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769336692","product_list":["logs"],"samplings":[]},"id":"e1dd1a1d-7a06-4502-96c8-331b8da25927","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},{"attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"Example-Create_Scanning_Group_returns_OK_response_1769495092","product_list":["logs"],"samplings":[]},"id":"cd20f1cf-6f14-4967-9794-f28f08ddb5a5","relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"}],"meta":{"count_limit":500,"group_count_limit":20,"has_cascading_enabled":false,"has_highlight_enabled":true,"has_multi_pass_enabled":true,"is_configuration_superseded":false,"is_float_sampling_rate_enabled":false,"is_pci_compliant":false,"min_sampling_rate":10,"rule_count_limit":500,"version":286465}}'
    headers:
      content-type:
      - application/vnd.api+json
    status:
      code: 200
      message: OK
- request:
    body: '{"data":{"attributes":{"filter":{"query":"*"},"is_enabled":false,"name":"my-test-group","product_list":["logs"],"samplings":[{"product":"logs","rate":100}]},"relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}},"type":"sensitive_data_scanner_group"},"meta":{}}'
    headers:
      accept:
      - application/json
      content-type:
      - application/json
    method: POST
    uri: https://api.datadoghq.com/api/v2/sensitive-data-scanner/config/groups
  response:
    body:
      string: '{"data":{"id":"f0288bc7-4f14-43bf-8f51-c0914df1d182","type":"sensitive_data_scanner_group","attributes":{"description":"","filter":{"query":"*"},"is_enabled":false,"name":"my-test-group","product_list":["logs"],"samplings":[{"product":"logs","rate":100}]},"relationships":{"configuration":{"data":{"id":"7957915c634d4dcb581fa154157f5ad9c2947f50be632fb5599862069f4d2d87","type":"sensitive_data_scanner_configuration"}},"rules":{"data":[]}}},"meta":{"group_count_limit":20,"rule_count_limit":500,"is_pci_compliant":false,"has_highlight_enabled":true,"has_multi_pass_enabled":true,"has_cascading_enabled":false,"is_configuration_superseded":false,"is_float_sampling_rate_enabled":false,"min_sampling_rate":10,"version":286465,"count_limit":500}}'
    headers:
      content-type:
      - application/vnd.api+json
    status:
      code: 201
      message: Created
- request:
    body: '{"data":{"attributes":{"excluded_namespaces":["admin.name"],"included_keyword_configuration":{"character_count":35,"keywords":["credit
      card"]},"is_enabled":true,"name":"Test-Create_Scanning_Rule_returns_OK_response-1770219312","namespaces":["admin"],"pattern":"pattern","priority":1,"tags":["sensitive_data:true"],"text_replacement":{"type":"none"}},"relationships":{"group":{"data":{"id":"f0288bc7-4f14-43bf-8f51-c0914df1d182","type":"sensitive_data_scanner_group"}}},"type":"sensitive_data_scanner_rule"},"meta":{}}'
    headers:
      accept:
      - application/json
      content-type:
      - application/json
    method: POST
    uri: https://api.datadoghq.com/api/v2/sensitive-data-scanner/config/rules
  response:
    body:
      string: '{"data":{"id":"b14f367d-9a45-4ced-b475-7384f7dba78c","type":"sensitive_data_scanner_rule","attributes":{"excluded_namespaces":["admin.name"],"included_keyword_configuration":{"keywords":["credit
        card"],"character_count":35},"is_enabled":true,"labels":[],"name":"Test-Create_Scanning_Rule_returns_OK_response-1770219312","namespaces":["admin"],"pattern":"pattern","priority":1,"tags":["sensitive_data:true"],"text_replacement":{"type":"none"}},"relationships":{"group":{"data":{"id":"f0288bc7-4f14-43bf-8f51-c0914df1d182","type":"sensitive_data_scanner_group"}}}},"meta":{"version":286467}}'
    headers:
      content-type:
      - application/vnd.api+json
    status:
      code: 201
      message: Created
- request:
    body: '{"meta":{}}'
    headers:
      accept:
      - application/json
      content-type:
      - application/json
    method: DELETE
    uri: https://api.datadoghq.com/api/v2/sensitive-data-scanner/config/rules/b14f367d-9a45-4ced-b475-7384f7dba78c
  response:
    body:
      string: '{"meta":{"version":286468}}'
    headers:
      content-type:
      - application/vnd.api+json
    status:
      code: 200
      message: OK
- request:
    body: '{"meta":{}}'
    headers:
      accept:
      - application/json
      content-type:
      - application/json
    method: DELETE
    uri: https://api.datadoghq.com/api/v2/sensitive-data-scanner/config/groups/f0288bc7-4f14-43bf-8f51-c0914df1d182
  response:
    body:
      string: '{"meta":{"version":286469}}'
    headers:
      content-type:
      - application/vnd.api+json
    status:
      code: 200
      message: OK
version: 1

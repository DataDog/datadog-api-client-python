# Unless explicitly stated otherwise all files in this repository are licensed under the Apache-2.0 License.
# This product includes software developed at Datadog (https://www.datadoghq.com/).
# Copyright 2019-Present Datadog, Inc.
from __future__ import annotations

from typing import List, Union, TYPE_CHECKING

from datadog_api_client.model_utils import (
    ModelNormal,
    cached_property,
    unset,
    UnsetType,
)


if TYPE_CHECKING:
    from datadog_api_client.v2.model.cyclone_dx_advisory import CycloneDXAdvisory
    from datadog_api_client.v2.model.cyclone_dx_affect import CycloneDXAffect
    from datadog_api_client.v2.model.cyclone_dx_rating import CycloneDXRating
    from datadog_api_client.v2.model.cyclone_dx_reference import CycloneDXReference


class CycloneDXVulnerability(ModelNormal):
    validations = {
        "affects": {
            "min_items": 1,
        },
        "ratings": {
            "max_items": 1,
            "min_items": 1,
        },
    }

    @cached_property
    def openapi_types(_):
        from datadog_api_client.v2.model.cyclone_dx_advisory import CycloneDXAdvisory
        from datadog_api_client.v2.model.cyclone_dx_affect import CycloneDXAffect
        from datadog_api_client.v2.model.cyclone_dx_rating import CycloneDXRating
        from datadog_api_client.v2.model.cyclone_dx_reference import CycloneDXReference

        return {
            "advisories": ([CycloneDXAdvisory],),
            "affects": ([CycloneDXAffect],),
            "cwes": ([int],),
            "description": (str,),
            "detail": (str,),
            "id": (str,),
            "ratings": ([CycloneDXRating],),
            "references": ([CycloneDXReference],),
        }

    attribute_map = {
        "advisories": "advisories",
        "affects": "affects",
        "cwes": "cwes",
        "description": "description",
        "detail": "detail",
        "id": "id",
        "ratings": "ratings",
        "references": "references",
    }

    def __init__(
        self_,
        affects: List[CycloneDXAffect],
        id: str,
        ratings: List[CycloneDXRating],
        advisories: Union[List[CycloneDXAdvisory], UnsetType] = unset,
        cwes: Union[List[int], UnsetType] = unset,
        description: Union[str, UnsetType] = unset,
        detail: Union[str, UnsetType] = unset,
        references: Union[List[CycloneDXReference], UnsetType] = unset,
        **kwargs,
    ):
        """
        A vulnerability in the CycloneDX BOM.

        :param advisories: List of advisory references.
        :type advisories: [CycloneDXAdvisory], optional

        :param affects: List of component references affected by this vulnerability.
        :type affects: [CycloneDXAffect]

        :param cwes: List of CWE (Common Weakness Enumeration) identifiers.
        :type cwes: [int], optional

        :param description: Description of the vulnerability.
        :type description: str, optional

        :param detail: Detailed information about the vulnerability.
        :type detail: str, optional

        :param id: The unique identifier of the vulnerability (e.g., CVE ID).
        :type id: str

        :param ratings: List of vulnerability ratings. Must contain exactly one rating.
        :type ratings: [CycloneDXRating]

        :param references: List of external references for the vulnerability.
        :type references: [CycloneDXReference], optional
        """
        if advisories is not unset:
            kwargs["advisories"] = advisories
        if cwes is not unset:
            kwargs["cwes"] = cwes
        if description is not unset:
            kwargs["description"] = description
        if detail is not unset:
            kwargs["detail"] = detail
        if references is not unset:
            kwargs["references"] = references
        super().__init__(kwargs)

        self_.affects = affects
        self_.id = id
        self_.ratings = ratings
